{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "CV Data Schema",
  "description": "Schema for AI chat-bot CV data structure with embeddings support",
  "type": "object",
  "required": ["metadata", "sections", "personality", "responseTemplates"],
  "properties": {
    "metadata": {
      "type": "object",
      "required": ["version", "lastUpdated", "totalSections", "embeddingModel", "embeddingDimensions"],
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+$"
        },
        "lastUpdated": {
          "type": "string",
          "format": "date"
        },
        "totalSections": {
          "type": "integer",
          "minimum": 1
        },
        "embeddingModel": {
          "type": "string"
        },
        "embeddingDimensions": {
          "type": "integer",
          "minimum": 1
        }
      }
    },
    "sections": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z_]+$": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z_]+$": {
              "$ref": "#/definitions/cvSection"
            }
          }
        }
      }
    },
    "personality": {
      "type": "object",
      "required": ["traits", "values", "workStyle", "interests", "communication_style"],
      "properties": {
        "traits": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "values": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "workStyle": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "interests": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "communication_style": {
          "type": "object",
          "required": ["hr", "developer", "friend"],
          "properties": {
            "hr": {
              "$ref": "#/definitions/communicationStyle"
            },
            "developer": {
              "$ref": "#/definitions/communicationStyle"
            },
            "friend": {
              "$ref": "#/definitions/communicationStyle"
            }
          }
        }
      }
    },
    "responseTemplates": {
      "type": "object",
      "required": ["noMatch", "lowConfidence", "fallbackRequest", "emailFallback"],
      "properties": {
        "noMatch": {
          "$ref": "#/definitions/styleResponses"
        },
        "lowConfidence": {
          "$ref": "#/definitions/styleResponses"
        },
        "fallbackRequest": {
          "$ref": "#/definitions/styleResponses"
        },
        "emailFallback": {
          "$ref": "#/definitions/styleResponses"
        }
      }
    }
  },
  "definitions": {
    "cvSection": {
      "type": "object",
      "required": ["id", "keywords", "embeddings", "responses", "details"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9_]+$"
        },
        "keywords": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "embeddings": {
          "oneOf": [
            {
              "type": "null"
            },
            {
              "type": "array",
              "items": {
                "type": "number"
              }
            }
          ]
        },
        "responses": {
          "$ref": "#/definitions/styleResponses"
        },
        "details": {
          "type": "object"
        },
        "relatedSections": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "styleResponses": {
      "type": "object",
      "required": ["hr", "developer", "friend"],
      "properties": {
        "hr": {
          "type": "string",
          "minLength": 10
        },
        "developer": {
          "type": "string",
          "minLength": 10
        },
        "friend": {
          "type": "string",
          "minLength": 10
        }
      }
    },
    "communicationStyle": {
      "type": "object",
      "required": ["tone", "language", "focus", "greeting"],
      "properties": {
        "tone": {
          "type": "string"
        },
        "language": {
          "type": "string"
        },
        "focus": {
          "type": "string"
        },
        "greeting": {
          "type": "string",
          "minLength": 10
        }
      }
    }
  }
}